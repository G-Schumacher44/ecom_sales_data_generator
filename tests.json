[{"stmt":"WITH return_item_counts AS (\n  SELECT\n    return_id,\n    COUNT(return_item_id) AS items_per_return\n  FROM return_items\n  GROUP BY\n    1\n)\nSELECT\n  items_per_return,\n  COUNT(return_id) AS number_of_returns\nFROM return_item_counts\nGROUP BY\n  1\nORDER BY\n  1;","header":["items_per_return","number_of_returns"],"rows":[["1","576"],["2","527"],["3","422"],["4","363"],["5","330"],["6","320"],["7","266"],["8","221"]]},{"stmt":"WITH signup_cohorts AS (\n  SELECT\n    customer_id,\n    STRFTIME('%Y-%m-01', signup_date) AS cohort_month\n  FROM customers\n  WHERE\n    is_guest = FALSE\n),\nactivity AS (\n  SELECT\n    customer_id,\n    STRFTIME('%Y-%m-01', order_date) AS activity_month\n  FROM orders\n),\ncohort_monthly_activity AS (\n  SELECT\n    c.cohort_month,\n    a.activity_month,\n    COUNT(DISTINCT c.customer_id) AS active_users\n  FROM signup_cohorts c\n  JOIN activity a\n    ON c.customer_id = a.customer_id\n  GROUP BY\n    1,\n    2\n),\nretention_decay AS (\n  SELECT\n    cohort_month,\n    activity_month,\n    active_users,\n    LAG(active_users, 1, active_users) OVER (PARTITION BY cohort_month ORDER BY activity_month) AS prev_month_users\n  FROM cohort_monthly_activity\n)\nSELECT\n  cohort_month,\n  activity_month,\n  (1.0 - (active_users * 1.0 / prev_month_users)) * 100 AS decay_rate_pct\nFROM retention_decay\nWHERE\n  cohort_month <= STRFTIME('%Y-%m-01', DATE('now', '-4 months')) -- Focus on mature cohorts\nORDER BY\n  1,\n  2;","header":[],"rows":[]},{"stmt":"SELECT\n  customer_id,\n  COUNT(DISTINCT customer_tier) AS distinct_tiers_on_orders\nFROM orders\nWHERE\n  customer_id IS NOT NULL\nGROUP BY\n  1\nHAVING\n  distinct_tiers_on_orders > 1;","header":[],"rows":[]},{"stmt":"WITH channel_clv_counts AS (\n  SELECT\n    signup_channel,\n    clv_bucket,\n    COUNT(customer_id) AS num_customers\n  FROM customers\n  WHERE\n    signup_channel IS NOT NULL AND clv_bucket IS NOT NULL\n  GROUP BY\n    1,\n    2\n),\nchannel_totals AS (\n  SELECT\n    signup_channel,\n    SUM(num_customers) AS total_customers\n  FROM channel_clv_counts\n  GROUP BY\n    1\n)\nSELECT\n  c.signup_channel,\n  c.clv_bucket,\n  c.num_customers,\n  t.total_customers,\n  ROUND(c.num_customers * 100.0 / t.total_customers, 2) AS percentage_of_channel\nFROM channel_clv_counts c\nJOIN channel_totals t\n  ON c.signup_channel = t.signup_channel\nORDER BY\n  1,\n  5 DESC;","header":["signup_channel","clv_bucket","num_customers","total_customers","percentage_of_channel"],"rows":[["","","20000","20000","100.0"],["Phone","High","1388","3014","46.05"],["Phone","Low","856","3014","28.4"],["Phone","Medium","770","3014","25.55"],["Social Media","Low","2480","4507","55.03"],["Social Media","Medium","1222","4507","27.11"],["Social Media","High","805","4507","17.86"],["Website","Low","7528","16466","45.72"],["Website","High","4545","16466","27.6"],["Website","Medium","4393","16466","26.68"],["email","Low","2237","6013","37.2"],["email","Medium","2143","6013","35.64"],["email","High","1633","6013","27.16"],["signup_channel","clv_bucket","1","1","100.0"]]}]